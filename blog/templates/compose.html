{% extends "base.html" %}

{% block body %}
<div class="inner">
<!-- request.path 是当前请求的url -->
<form action="{{ request.path }}" method="post" class="compose">
        <div class="form-group row">
                <label for="staticUser" class="col-sm-2 col-form-label">标题</label>
                <div class="col-sm-10"><input name="title" type="text" class="form-control" value="{{ entry.title if entry else "" }}" /></div>
        </div>
        <div class="form-group row">
                <label for="staticUser" class="col-sm-2 col-form-label">slug</label>
                <div class="col-sm-8"><input name="slug" type="text" class="form-control" value="{{ entry.slug if entry else "" }}" /></div>
                <button id="translate" type="button" class="btn btn-primary mb-2">翻译</button>
        </div>
        <div style="margin-bottom:5px"><textarea class="form-control" name="markdown" rows="30">{{ entry.markdown if entry else "" }}</textarea></div>
        <div>
                <div style="float:right"><a
                        href="http://daringfireball.net/projects/markdown/syntax">{{ _("Syntax documentation") }}</a></div>
                <button type="submit" class="btn btn-primary mb-2">{{ _("Save changes") if entry else _("Publish post") }}</button>
                &nbsp;<a class="btn btn-danger mb-2" href="{{ "/entry/" + entry.slug if entry else "/" }}">{{ _("Cancel") }}</a>
        </div>
        {% if entry %}
        <input type="hidden" name="id" value="{{ entry._id }}" />
        {% end %}
        {% module xsrf_form_html() %}
</form>
</div>
{% end %}

{% block bottom %}
<script type="text/javascript">
    //<![CDATA[
    
    $(function() {
        $("button#translate").click(function() {
                var title = $("input[name='title']")[0].getAttribute('value')
                var url = "http://fanyi.youdao.com/translate?&doctype=json&type=AUTO&i=" + title
                $.getJSON(url, function(data) {
                        console.log(data)
                })
        })
    });
  
    //]]>
    </script>
{% end %}